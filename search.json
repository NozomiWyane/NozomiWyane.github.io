[{"title":"Deep Learning Nerual Network 1","date":"2022-10-19T13:45:39.231Z","url":"/2022/10/19/DeepLearningByAndrewNg1/","categories":[["undefined",""]],"content":"第一课神经网络的有监督学习建立y(y1,y2…)到x(x1,x2,x3,x4…)的映射关系，我们给出数据包含(x,y)对神经网络进行训练，找到最佳的参数来表达y和x之间的关系。 有监督学习的x输入结构化数据：表格类型的，矩阵类型的数据非结构化数据：声音，图像，文本等 神经网络基础神经网络包含前向过程(forward propagation) 和 反向传播过程(backward propagation)即BP 简单的二元逻辑回归例子 问题模型描述：输入x∈Rnx，是输出y则是label∈{0,1},一共有m个训练样本{(x1,y1),(x2,y2)…(xm,ym)} 对于训练样本的m个输入x，进行堆叠为一个nx × m的矩阵，y同样为1 x m的矩阵 在这里我们使用$\\hat{y}$表示通过算法预测的结果，我们需要它与y形成一个概率的关系，即取值为{0~1},由于直接使用线性函数去拟合，我们输出只有0~1的情况下，有可能会输出负数,或者超过1，这里我们使用一个叫sigmoid函数对线性拟合处理，sigmoid表示为如下$\\frac{1}{1+e-z}$,原来y = wTx + b表示为y = $\\delta$ (wTx + b) 梯度下降上述损失函数很好地描述了w和b对Y和$\\hat{y}$之间的的关系，但是我们要得到更好地使得J(w,b)更小，在这里我们提出梯度下降法来求解w和b使得J(w,b)最小。 神经网络的理解 如上图，神经网络可以理解为是一个黑箱，函数，输入图像，经过结构和参数得到里面是否有猫，有=1，无=0，这是一个基本的神经网络的模式。 神经网络模型 = 结构 + 参数 我们的目标就是要找到在结构中最佳的参数来的到最好的结果，我们可以改变这个模式中的很多东西： 输入input，将图片换成其他的数据格式 输出output，改变求解问题，如要求猫的种类(多类分类)，猫的年龄(线性回归) 损失函数Loss function，根据与真值的比较定义的误差来更新 结构Architecture，一般以结构来命名神经网络如循环神经网络，卷积神经网络等 激活函数Activation function， 优化器Optiomizer, 超参数Hyperparameters，如学习率,优先的批处理等外部设置的参数 其中几个例子一、分类问题问题描述：给一张图片，要分辨出是猫或不是猫（白天或黑夜）问题分析： 输入：表示为像素矩阵的图片(二维矩阵) 输出：类型（猫或非猫） 损失函数：二元逻辑回归，目标是猫（0），不是猫是(1)，设置阈值如(0.5) 结构：有很多如CNN,RCNN等 激活函数：使用sigmoid函数，使得输出保持在0~1之间 如果是多分类问题（分类几种动物）有以下几个解决方法： 单热编码，这样能在一张图片上同时出现两种动物，但这样需要使用softmax激活函数。 训练多神经网络，每一个对应一种动物，这样效率不高不能有效利用。 训练时，需要输入多张带标签的动物图片，在训练时进行带标签（编码）的训练 二、人像识别问题描述：输入人脸后，需要知道是不是对应学生（id）的问题分析： 输入: 表示为像素矩阵的图片(二维矩阵) 输出：判断是否为指定的学生，二分类，设置阈值 损失函数：输入的待认证图像与图像库中的图像进行匹配，向量化的差值基本与上面相同，但比较先进的人脸识别方法应该不是这样的，有一定的改进但总体思路是一样的。 三、风格转移问题描述：给出一张图片的内容和另一张图片的风格，生成1图片内容含2图片风格问题分析： 数据：目标content和目标style图 输入：随机白噪声或带偏置的图（或其他的） 输出：含有content和style的图 损失函数：生成的图片同时与content之间的内容差值和style图之间的style差值 四、语音识别问题描述：给出一段语音，识别出其中的激活词问题分析： 数据：很多包含或不包含（正负样本）激活词的样本集，有两种方式： ①：找很多人录音，手动标记； ②：收集正样本和负样本插入到背景噪音中，可以程序化生成样本并自动标记 输入：一段待识别的语音 输出：对每个时序输出0或1来识别激活词 损失函数：编码后的语音与激活词之间的距离 结构：RNN，LSTM结构 虽然以上方法很好地定义了其中很多内容，但关键影响效果的是结构和它的参数调整能否有效"},{"title":"Deep Learning Nerual Network","date":"2022-10-19T13:45:39.211Z","url":"/2022/10/19/DeepLearningByAndrewNg/","categories":[["undefined",""]],"content":"Stanford CS230(吴恩达 深度学习 Deep Learning | Autumn 2018)笔记第零课深度学习是什么？深度学习一般与神经网络是一个同义词，Deep Learning简称DL，与传统的Machine Learning(ML)不同，但是是ML的一部分，也是最难的一部分。 深度学习兴起主要是由于互联网发展以及GPU计算的能力提升，更多数据被电子化以及计算力的大幅提升，使得神经网络变得更大更能解决更多数据带来的问题和潜在的有价值的东西。 一个好的AI团队需要什么？ 团队一般具备各种数据采集能力 团队能通过深度学习来对数据进行分析 普遍的自动化 本课程含五个Courses： 什么是神经元？什么是神经网络层？如何将他们堆叠起来搭建神经网络？ 如何调整(tune)这些神经网络？如何改进神经网络的效果？ 机器学习项目的开发流程 卷积神经网络(CNN Convolutional Neural Network) 序列模型(Sequence Model)如递归神经网络(Recurrent Neural Network) 参考课程视频：对于2中的每一个视频，先到1中看了视频在看2，效果会好一些 2中视频备注如C1M1，代表第一个Courses(一共上面5个),每个有很多modules，一般一个视频两个modules Courses In-class "},{"title":"DataFile Dealing","date":"2022-10-19T13:45:39.158Z","url":"/2022/10/19/DataFile%20Dealing/","categories":[["undefined",""]],"content":"裂开由于利用mahjong-helper处理麻将牌谱,整理一下几种人工智能数据格式在python中的处理方式。 xls和xlsxpython中对于这两种文件有三个库可以用，xlwt，xlrd和openpyxl，这里以xlrd为例，其他两个大同小异。 excel文档有三个概念，workbook(文档)，sheet(表单)，cell(单元格)，以下是一个demo遍历每一个单元格： csvcsv跟上面的不一样，它默认有表头，并且只能存一张表，用的是pandas的read_csv函数来读的，返回的是pandas的DataFrame对象。 hdf5这个是最复杂的文件结构，它用的是类Unix的文件组织结构来组织文件。在python中用的是h5py的库"},{"title":"Mahjong AI [AkagiShigeru]","date":"2022-10-19T13:45:38.565Z","url":"/2022/10/19/mahjong%20AI/","categories":[["undefined",""]],"content":"简介这是一个关于日本麻将人工智能算法的笔记，期望以后能进行推进开发实用。 相关文献 NaoKi Mizukami 水上直紀 多人数性を分割した教師付き学習による四人麻雀プログラムの実現原版 中文版 NaoKi Mizukami 水上直紀 Building a Computer Mahjong Player Based on Monte Carlo Simulation and Opponent Models原版 中文版 NaoKi Mizukami 水上直紀 期待最終順位に基づくコンピュータ麻雀プレイヤの構築原版 Ryouhei KITAGAWA 北川竜平 麻雀の牌譜からの打ち手評価関数の学習原版 NaoKi Mizukami 水上直紀 牌譜を用いた対戦相手のモデル化とモンテカルロ法によるコンピュータ麻雀プレイヤの構築 NaoKi Mizukami 水上直紀 強化学習を用いた効率的な和了を行う麻雀プレイヤ NaoKi Mizukami 水上直紀 多人数不完全情報ゲームにおける仮想自己対戦を用いた強化学習 NaoKi Mizukami 水上直紀 降りるべき局面の認識による1 人麻雀プレイヤの4 人麻雀への適用 感谢译者 零之审判(北京大学数学科学学院 学士毕业) 译者注 译者关于这几篇论文的看法以及理解，很值得一看 感谢本博客基于的是mahjong-helper的代码。该平台支持天凤和雀魂，查看和分析牌谱，实时获取当前数据，并进行分析，同时跨平台支持linux，windows和mac。~日麻杂谈群375865038~ 我在其中添加该算法，使用的是该平台的雀魂平台上进行试验。 日本麻将术语暂时不写了，是日麻基本规则 基于有监督的单人麻将程序 这部分讲述三篇水上直紀大佬写的三篇文章中，关于单人麻将的算法以及它们的基本原理，本人理解有限，希望能复现他们的工作(希望能改进)。 单人麻将的规则所以基本就是一直摸切摸切，有点像第一代雀魂的AI，不会鸣牌(因为单人麻将不能鸣牌)，一直摸直到流局或立直。 基于平均感知器的算法这是第一篇文章中的单人麻将的算法，利用的是基于平均感知器的算法来减少向听达成自摸。平均感知器是基于条件随机场的的全局化以最大熵准则建模的函数的一个有监督模型。[1] 算法流程文章中使用的特征量提取模型，是用的2007年北川论文中的特征量。引用译者的翻译: 特征类 特征个数 面子手、七对子、国士无双向听数 15+7+14=36 3色（万、筒、索）中不使用n色（n=1˜ 3）的n和向听数 3×16=48 色的个数（1˜ 4）及各色向听数的组合 12+78+364+1365=1819 各色牌中最多的数量 15 各色牌中最多的数量+字牌数 15 2到8的数牌量 15 面子和不含有幺九的连续2张牌的搭子和面子候补的组合 6+12+72=90 各字牌的枚数和役牌的枚数和是否是宝牌的组合 5×6×2=60 数牌的数字-5的绝对值和枚数和是否是宝牌的组合 5×5×2=50 各色牌中是否有1˜ 9的组合 512 连续的n个数牌中各牌数量的组合（n=2˜ 6） 100+500+1860+8634+23760=34854 我们来分析一下某几个特征量是怎么算出来的，例如第一行中的国士无双向听数，最简单的就是0向听˜13向听，那就是一共14种情况，即特征个数。七对子也是0˜7向听等。 对于所有牌谱中的手牌(局面),当轮到主视角时，手牌有14张，我们来计算切掉每一张牌后，剩下的13张牌所组成的特征量的得分。 $f(x,w)=\\sum_{i=1}^{n}x_iw_i$ 一共有14张牌得分，计算出得分最高的切牌$\\widehat{t}$的得分以及实际切牌$t*$的得分，如果不相同则以实际切牌的为准，并更新权重，根据两个切牌的特征向量，原权重加上实际切牌的权重再减去最高得分切牌权重，更新公式如下 $w^{‘}=w+x{t*}-x\\widehat{t}$ 遍历三遍输入训练数据后，输出权重，根据得分最高的来打牌。 有监督训练集由于使用的是牌谱的有监督学习，且是单人麻将，文章中采用的牌谱是天凤凤凰桌所有局中，第一个立直的人直到立直的所有切牌数据作为训练数据，一共有170万个局面(手牌状况)。但是作者并没有公开这些数据，复现这个方法需要大量的牌谱，而且是顶尖选手的牌谱。 攻防判断——识别是否弃和该部分是识别当前的局面是否应该弃和，在这篇文章中，采用的是二分类法，用了SVM的分类器根据局面上提取的特征来判断是否弃和。同时，如果一个局面被标记为弃和后，之后的所有局面都应标记为弃和。而兜牌是不被标记为弃和的，只是进攻的一个手段。 同时文章提及是否弃和是一个比较主观的定义，是有一些局面的判断是非常难判断的。但考虑到人类玩家弃和的思考方式，采用安全度来判断是否弃和： 标记好数据后，使用SVM分类器，判断是否弃和的特征向量如下，共7+3*8+3=34维。 特征类 数量 自身状态 向听数 1 七对子向听数 1 是否立直 1 是否坐庄 1 副露数 1 副露的宝牌数 1 手牌宝牌数 1 对手状态 是否立直 1 副露数 1 副露可见的宝牌数 1 是否坐庄 1 想切的牌对该玩家安全度 4 场上状况 牌山剩余量 1 杠的数量 1 牌河里宝牌数量 1 加入程序鸣牌的能力鸣牌程序训练跟第一部分单人程序大致相同，使用鸣牌局面的牌谱来进行训练，同样使用平均感知器算法来对局面的所有特征向量来分类，下表是跟单人麻将差不多的特征向量： 特征类 特征个数 副露数 5 是否可能立直 2 各色的1˜9数牌数量变换到0，1，2以上的牌型 19472 副露里选择n（1˜2）个副露的种类组合 136+9316=9452 手牌里有3张以上相同牌的数量和2张以上相同牌的数量的组合 5×7=35 手牌里有3张以上相同牌的数量+碰的个数和2张以上相同牌的数量的组合，还有是否吃牌 5×7+1=36 手牌和副露中断幺牌数量和向听数 16+16=32 连续的各色的3张数牌里的有无和3张里是否包含幺九和是否包含吃的组合 512×2×2=2048 包含吃的各色里幺九的有无 512 各色牌中最多的数量+该色和字牌的副露数×3 16 各色牌中最多的数量+字牌个数+该色和字牌的副露数×3 16 做特定色染手的向听数 16 役牌对子数 8 役牌刻子数 6 宝牌个数（0，1，2，3以上）和2˜8数牌中宝牌数量 4+4=8 副露数和向听数的组合 5×15=75 向听数和有役、有门清限定役、没役和巡目的组合 2×3×19=114 有役和是否是门清限定役和没有役 3 是否鸣了幺九牌和加入幺九牌时向听数减少的量（0，1，2以上） 2×3=6 手牌里不使用幺九牌的向听数增加的量（0，1，2以上） 3 加上所有副露的风牌后其数量（0，1，2，3以上）的组合 4×4×4×4=256 加上所有副露的三元牌后其数量（0，1，2，3以上）的组合 4×4×4=64 副露数和向听数和加入已经切出的牌是否减少向听数的组合 5×4×2=40 结合单人麻将，攻防判断和鸣牌打法有了不鸣牌，攻防判断以及鸣牌的打法，就可以基本训练出电脑程序打麻将的逻辑所有部分 结合前面三个部分可以完成这个流程，完成打麻将的策略。 总结这个论文的程序基本提供了一种有监督的方法来训练程序对门清状态的打牌，攻防判断和鸣牌的打法学习。但仍有很多不足，在文中认为弃和后，不会再次副露。训练集都是能和牌的局面，那么在手牌难以和牌的时候进行错误鸣牌，文中也说能通过在训练样本中加入没有和牌的局面解决。 References [1]: 平均感知器  [2]: 手牌特征量分析 北川竜平、三輪 誠 、近山 隆. 麻雀の牌譜からの打ち手評価関数の学習. Proceedings of the 12thGame Programming Workshop, 2007"}]